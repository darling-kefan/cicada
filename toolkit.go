package cicada

import (
	"fmt"
	"os"

	"github.com/urfave/cli"
	"github.com/garyburd/redigo/redis"
)



func AdviewChannelAction(ctx *cli.Context) error {
	// Tvm Interests
	// 501 - 教育
	// 502 - 旅游
	// 503 - 金融
	// 504 - 汽车
	// 505 - 房产
	// 506 - 家居
	// 507 - 服饰鞋帽箱包
	// 508 - 餐饮美食
	// 509 - 生活服务
	// 510 - 商务服务
	// 511 - 美容
	// 512 - 互联网/电子产品
	// 513 - 体育运动
	// 514 - 医疗健康
	// 515 - 孕产育儿
	// 516 - 游戏
	// 517 - 娱乐休闲
	
	tvmInterests := map[string]string{
		"10103": "11",
		"10104": "12",
		"10105": "12",
		"10108": "17",
		"10200": "03,10",
		"10201": "10",
		"10202": "10",
		"10203": "10",
		"10204": "03",
		"10205": "03",
		"10206": "03",
		"10207": "03",
		"10208": "03,09",
		"10300": "12",
		"10301": "12",
		"10302": "12",
		"10604": "12",
		"10605": "12",
		"10701": "12",
		"10702": "12",
		"10900": "07,08,09",
		"10904": "08,09",
		"10908": "07,09",
		"10909": "09",
		"10910": "09",
		"10911": "07,09",
		"10912": "09",
		"10914": "11",
		"11000": "02",
		"11001": "02",
		"11002": "02,04",
		"11003": "02",
		"11004": "02",
		"11005": "02",
		"11006": "02",
		"11007": "02",
		"11008": "02",
		"11009": "02",
		"11010": "02",
		"11100": "01",
		"11101": "01",
		"11102": "01",
		"11103": "01",
		"11104": "01",
		"11105": "01",
		"11106": "01",
		"11107": "01",
		"11108": "01",
		"11109": "01",
		"11208": "16",
		"11300": "14",
		"11301": "14",
		"11302": "14",
		"11303": "15",
		"11304": "14",
		"11305": "13",
		"20100": "16",
		"20101": "16",
		"20102": "16",
		"20103": "16",
		"20104": "16",
		"20105": "16",
		"20106": "16",
		"20107": "16",
		"20108": "16",
		"20109": "16",
		"20200": "16",
		"20201": "16",
		"20202": "16",
		"20203": "16",
		"20204": "16",
		"20300": "13",
		"20301": "16,13",
		"20302": "16",
		"20303": "16",
		"20304": "16,04",
		"20305": "16,04",
		"20306": "16,13",
		"20307": "16,13",
		"20308": "16,13",
		"20309": "16",
		"20400": "16",
		"20401": "16",
		"20402": "16",
		"20403": "16",
		"20404": "16",
		"20405": "16",
		"20406": "16",
		"20407": "16",
		"20500": "16",
		"20501": "16",
		"20502": "16",
		"20503": "16",
		"20504": "16",
		"20505": "16",
		"20506": "16",
		"20507": "16",
		"20600": "16",
		"20601": "16",
		"20602": "16",
		"20603": "16",
		"20604": "16",
		"20700": "16,17",
		"20701": "16,17",
		"20702": "16,17",
		"20703": "16,01",
		"20704": "16,01",
		"20705": "16,01",
		"20706": "16,17",
		"20707": "16,17",
		"20800": "16,17",
		"20801": "16,17",
		"20802": "16,17",
		"20803": "16,01,17",
		"20804": "16,01,17",
		"20805": "16,17",
		"20806": "16,17",
		"20807": "16,17",
		"20808": "16,17",
		"20809": "16,17",
	}

	host := ctx.String("host")
	port := ctx.String("port")
	redisConn, err := redis.Dial("tcp", host+":"+port)
	if err != nil {
		fmt.Println(err)
		os.Exit(1)
	}
	defer redisConn.Close()

	values := make([]interface{}, len(tvmInterests)*2+1)
	key := "interests:adview2ztc"
	values[0] = key
	n := 1
	for k, v := range tvmInterests {
		values[n] = k
		values[n+1] = v
		n = n + 2
	}

	status, err := redisConn.Do("hmset", values...)
	if err != nil {
		fmt.Println(err)
		os.Exit(1)
	}
	
	fmt.Printf("hmset %s values: %v %s\n", key, values[1:], status)
	
	return nil
}
